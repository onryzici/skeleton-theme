{% comment %}
  Image with Text Section
  Flexible layout combining imagery with rich content
  Supports multiple layouts and content blocks
{% endcomment %}

<style>
  /* Animations */
  @keyframes fadeInLeft {
    from {
      opacity: 0;
      transform: translateX(-40px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes fadeInRight {
    from {
      opacity: 0;
      transform: translateX(40px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes zoomIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  /* Section animations based on layout */
  #shopify-section-{{ section.id }} .iwt-image {
    {% if section.settings.layout == 'image_top' or section.settings.layout == 'stacked' %}
      animation: fadeInUp 0.8s ease forwards;
    {% elsif section.settings.layout == 'image_first' %}
      animation: fadeInLeft 0.8s ease forwards;
    {% else %}
      animation: fadeInRight 0.8s ease forwards;
    {% endif %}
  }

  #shopify-section-{{ section.id }} .iwt-content {
    {% if section.settings.layout == 'image_top' or section.settings.layout == 'stacked' %}
      animation: fadeInUp 0.8s ease forwards 0.2s;
    {% elsif section.settings.layout == 'image_first' %}
      animation: fadeInRight 0.8s ease forwards 0.2s;
    {% else %}
      animation: fadeInLeft 0.8s ease forwards 0.2s;
    {% endif %}
    opacity: 0;
  }

  #shopify-section-{{ section.id }} .iwt-image img {
    transition: transform 0.6s ease;
  }

  #shopify-section-{{ section.id }} .iwt-image:hover img {
    transform: scale(1.05);
  }

  /* Image container styling */
  #shopify-section-{{ section.id }} .iwt-image-container {
    border-radius: {{ section.settings.image_radius }}px;
    overflow: hidden;
    background: {{ section.settings.image_bg_color | default: '#f3f4f6' }};
  }

  /* Section padding */
  #shopify-section-{{ section.id }} .iwt-section {
    padding-top: {{ section.settings.padding_top_mobile }}px;
    padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
    background: {{ section.settings.section_bg_color | default: '#ffffff' }};
  }

  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .iwt-section {
      padding-top: {{ section.settings.padding_top_desktop }}px !important;
      padding-bottom: {{ section.settings.padding_bottom_desktop }}px !important;
    }
  }

  /* Content block stagger animations */
  {% for block in section.blocks %}
    #shopify-section-{{ section.id }} .iwt-block-{{ forloop.index }} {
      animation: fadeInUp 0.6s ease forwards;
      animation-delay: {{ forloop.index | times: 0.1 | plus: 0.3 }}s;
      opacity: 0;
    }
  {% endfor %}

  /* Button hover effects */
  #shopify-section-{{ section.id }} .iwt-button-primary {
    transition: all 0.3s ease;
  }

  #shopify-section-{{ section.id }} .iwt-button-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2);
  }

  #shopify-section-{{ section.id }} .iwt-button-secondary {
    transition: all 0.3s ease;
    position: relative;
  }

  #shopify-section-{{ section.id }} .iwt-button-secondary:hover {
    transform: translateX(5px);
  }
</style>

<div class="iwt-section w-full">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">

    {%- liquid
      assign is_stacked = false
      assign is_image_top = false
      if section.settings.layout == 'stacked' or section.settings.layout == 'image_top'
        assign is_stacked = true
      endif
      if section.settings.layout == 'image_top'
        assign is_image_top = true
      endif
    -%}

    <div class="{% if is_stacked %}flex flex-col gap-8 lg:gap-12 items-center{% else %}grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 items-center{% endif %}
                {% if section.settings.layout == 'text_first' %}lg:grid-flow-dense{% endif %}">

      {% comment %} Image Column {% endcomment %}
      <div class="iwt-image
                  {% if is_stacked %}w-full{% endif %}
                  {% unless is_stacked %}
                    {% if section.settings.layout == 'text_first' %}lg:col-start-2{% endif %}
                  {% endunless %}
                  {% if is_image_top %}order-first{% elsif is_stacked %}order-last{% endif %}">
        <div class="iwt-image-container">
          {% if section.settings.image != blank %}
            <div class="aspect-{{ section.settings.image_ratio }} flex items-center justify-center p-6 lg:p-12">
              <img
                src="{{ section.settings.image | image_url: width: 1600 }}"
                alt="{{ section.settings.image.alt | escape }}"
                width="{{ section.settings.image.width }}"
                height="{{ section.settings.image.height }}"
                loading="lazy"
                srcset="{{ section.settings.image | image_url: width: 800 }} 800w,
                        {{ section.settings.image | image_url: width: 1200 }} 1200w,
                        {{ section.settings.image | image_url: width: 1600 }} 1600w"
                sizes="{% if is_stacked %}100vw{% else %}(max-width: 767px) 100vw, 50vw{% endif %}"
                class="w-full h-full object-{{ section.settings.image_fit }} rounded-2xl"
              >
            </div>
          {% else %}
            <div class="aspect-{{ section.settings.image_ratio }} flex items-center justify-center bg-gray-200 rounded-2xl">
              <div class="text-center text-gray-400 p-8">
                <svg class="w-16 h-16 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                <p class="text-sm font-sans">Add an image</p>
              </div>
            </div>
          {% endif %}
        </div>
      </div>

      {% comment %} Content Column {% endcomment %}
      <div class="iwt-content
                  {% if is_stacked %}w-full max-w-3xl text-center{% endif %}
                  {% unless is_stacked %}
                    {% if section.settings.layout == 'text_first' %}lg:col-start-1 lg:row-start-1{% endif %}
                  {% endunless %}">
        <div class="{% if is_stacked %}mx-auto{% else %}max-w-xl{% if section.settings.layout == 'text_first' %} ml-0 lg:ml-auto{% endif %}{% endif %}">

          {% for block in section.blocks %}
            {% case block.type %}

              {% when 'caption' %}
                <div class="iwt-block-{{ forloop.index }} mb-4" {{ block.shopify_attributes }}>
                  <span class="inline-block px-4 py-2 text-xs lg:text-sm font-semibold font-sans uppercase tracking-wider rounded-full
                               {% if block.settings.caption_style == 'filled' %}
                                 bg-gray-900 text-white
                               {% elsif block.settings.caption_style == 'outlined' %}
                                 border-2 border-gray-900 text-gray-900
                               {% else %}
                                 text-gray-600
                               {% endif %}">
                    {{ block.settings.caption }}
                  </span>
                </div>

              {% when 'heading' %}
                <div class="iwt-block-{{ forloop.index }} mb-6 lg:mb-8" {{ block.shopify_attributes }}>
                  <h2 class="text-2xl sm:text-3xl lg:text-4xl xl:text-5xl font-bold font-sans text-gray-900 leading-tight"
                      style="color: {{ block.settings.heading_color | default: '#111827' }};">
                    {{ block.settings.heading }}
                  </h2>
                </div>

              {% when 'text' %}
                <div class="iwt-block-{{ forloop.index }} mb-6 lg:mb-8" {{ block.shopify_attributes }}>
                  <div class="text-sm sm:text-base lg:text-lg font-sans text-gray-600 leading-relaxed space-y-4"
                       style="color: {{ block.settings.text_color | default: '#4b5563' }};">
                    {{ block.settings.text }}
                  </div>
                </div>

              {% when 'button' %}
                <div class="iwt-block-{{ forloop.index }} flex flex-col sm:flex-row gap-4 {% if is_stacked %}justify-center{% endif %}" {{ block.shopify_attributes }}>
                  {% if block.settings.button_label != blank %}
                    <a
                      href="{{ block.settings.button_link | default: '#' }}"
                      class="iwt-button-primary inline-flex items-center justify-center px-8 py-4 text-base font-semibold font-sans rounded-full transition-all
                             {% if block.settings.button_style == 'primary' %}
                               bg-gray-900 text-white hover:bg-gray-800
                             {% elsif block.settings.button_style == 'outline' %}
                               border-2 border-gray-900 text-gray-900 bg-transparent hover:bg-gray-900 hover:text-white
                             {% else %}
                               bg-gray-100 text-gray-900 hover:bg-gray-200
                             {% endif %}"
                    >
                      {{ block.settings.button_label }}
                    </a>
                  {% endif %}

                  {% if block.settings.button_label_secondary != blank %}
                    <a
                      href="{{ block.settings.button_link_secondary | default: '#' }}"
                      class="iwt-button-secondary inline-flex items-center justify-center gap-2 px-6 py-4 text-base font-medium font-sans text-gray-900 transition-all group"
                    >
                      <span>{{ block.settings.button_label_secondary }}</span>
                      <svg class="w-5 h-5 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                      </svg>
                    </a>
                  {% endif %}
                </div>

              {% when 'features' %}
                <div class="iwt-block-{{ forloop.index }} space-y-4 {% if is_stacked %}max-w-xl mx-auto{% endif %}" {{ block.shopify_attributes }}>
                  {% if block.settings.feature_1 != blank %}
                    <div class="flex items-start gap-3 {% if is_stacked %}justify-center text-center{% endif %}">
                      <svg class="w-6 h-6 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                      </svg>
                      <span class="text-base font-sans text-gray-700">{{ block.settings.feature_1 }}</span>
                    </div>
                  {% endif %}
                  {% if block.settings.feature_2 != blank %}
                    <div class="flex items-start gap-3 {% if is_stacked %}justify-center text-center{% endif %}">
                      <svg class="w-6 h-6 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                      </svg>
                      <span class="text-base font-sans text-gray-700">{{ block.settings.feature_2 }}</span>
                    </div>
                  {% endif %}
                  {% if block.settings.feature_3 != blank %}
                    <div class="flex items-start gap-3 {% if is_stacked %}justify-center text-center{% endif %}">
                      <svg class="w-6 h-6 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                      </svg>
                      <span class="text-base font-sans text-gray-700">{{ block.settings.feature_3 }}</span>
                    </div>
                  {% endif %}
                  {% if block.settings.feature_4 != blank %}
                    <div class="flex items-start gap-3 {% if is_stacked %}justify-center text-center{% endif %}">
                      <svg class="w-6 h-6 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                      </svg>
                      <span class="text-base font-sans text-gray-700">{{ block.settings.feature_4 }}</span>
                    </div>
                  {% endif %}
                </div>

            {% endcase %}
          {% endfor %}

        </div>
      </div>

    </div>

  </div>
</div>

{% schema %}
{
  "name": "Image with Text",
  "tag": "section",
  "class": "section-image-with-text",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "options": [
        {
          "value": "image_first",
          "label": "Horizontal - Image Left"
        },
        {
          "value": "text_first",
          "label": "Horizontal - Text Left"
        },
        {
          "value": "stacked",
          "label": "Vertical - Content on Top"
        },
        {
          "value": "image_top",
          "label": "Vertical - Image on Top"
        }
      ],
      "default": "image_first",
      "info": "Choose horizontal (side-by-side) or vertical (stacked) layout"
    },
    {
      "type": "header",
      "content": "Image Settings"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "label": "Image aspect ratio",
      "options": [
        {
          "value": "square",
          "label": "Square (1:1)"
        },
        {
          "value": "video",
          "label": "Video (16:9)"
        },
        {
          "value": "[4/3]",
          "label": "Landscape (4:3)"
        },
        {
          "value": "[3/4]",
          "label": "Portrait (3:4)"
        }
      ],
      "default": "square"
    },
    {
      "type": "select",
      "id": "image_fit",
      "label": "Image fit",
      "options": [
        {
          "value": "contain",
          "label": "Contain (show full image)"
        },
        {
          "value": "cover",
          "label": "Cover (fill area)"
        }
      ],
      "default": "contain"
    },
    {
      "type": "range",
      "id": "image_radius",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Image corner radius",
      "default": 48
    },
    {
      "type": "color",
      "id": "image_bg_color",
      "label": "Image background color",
      "default": "#f3f4f6"
    },
    {
      "type": "header",
      "content": "Section Colors"
    },
    {
      "type": "color",
      "id": "section_bg_color",
      "label": "Section background color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Section Padding"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding (mobile)",
      "default": 48
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding (mobile)",
      "default": 48
    },
    {
      "type": "range",
      "id": "padding_top_desktop",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Top padding (desktop)",
      "default": 80
    },
    {
      "type": "range",
      "id": "padding_bottom_desktop",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding (desktop)",
      "default": 80
    }
  ],
  "blocks": [
    {
      "type": "caption",
      "name": "Caption",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "caption",
          "label": "Caption text",
          "default": "NEW ARRIVAL"
        },
        {
          "type": "select",
          "id": "caption_style",
          "label": "Caption style",
          "options": [
            {
              "value": "filled",
              "label": "Filled"
            },
            {
              "value": "outlined",
              "label": "Outlined"
            },
            {
              "value": "plain",
              "label": "Plain text"
            }
          ],
          "default": "filled"
        }
      ]
    },
    {
      "type": "heading",
      "name": "Heading",
      "limit": 1,
      "settings": [
        {
          "type": "textarea",
          "id": "heading",
          "label": "Heading",
          "default": "Elevate your everyday"
        },
        {
          "type": "color",
          "id": "heading_color",
          "label": "Heading color",
          "default": "#111827"
        }
      ]
    },
    {
      "type": "text",
      "name": "Text",
      "limit": 2,
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "label": "Text",
          "default": "<p>Discover the perfect blend of style and functionality. Crafted with attention to detail and designed for modern living.</p>"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text color",
          "default": "#4b5563"
        }
      ]
    },
    {
      "type": "button",
      "name": "Buttons",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "button_label",
          "label": "Primary button label",
          "default": "Shop Now"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Primary button link"
        },
        {
          "type": "select",
          "id": "button_style",
          "label": "Primary button style",
          "options": [
            {
              "value": "primary",
              "label": "Primary (filled)"
            },
            {
              "value": "outline",
              "label": "Outline"
            },
            {
              "value": "secondary",
              "label": "Secondary"
            }
          ],
          "default": "primary"
        },
        {
          "type": "text",
          "id": "button_label_secondary",
          "label": "Secondary button label"
        },
        {
          "type": "url",
          "id": "button_link_secondary",
          "label": "Secondary button link"
        }
      ]
    },
    {
      "type": "features",
      "name": "Feature List",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "feature_1",
          "label": "Feature 1",
          "default": "Premium quality materials"
        },
        {
          "type": "text",
          "id": "feature_2",
          "label": "Feature 2",
          "default": "Sustainable production"
        },
        {
          "type": "text",
          "id": "feature_3",
          "label": "Feature 3",
          "default": "Free worldwide shipping"
        },
        {
          "type": "text",
          "id": "feature_4",
          "label": "Feature 4",
          "default": "2-year warranty included"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Image with Text",
      "blocks": [
        {
          "type": "caption"
        },
        {
          "type": "heading"
        },
        {
          "type": "text"
        },
        {
          "type": "button"
        }
      ]
    }
  ]
}
{% endschema %}
